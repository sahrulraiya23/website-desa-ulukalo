<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>APBDes – Desa Ulukalo</title>
  <meta name="description" content="Transparansi APBDes Desa Ulukalo: ringkasan anggaran, rincian pendapatan & belanja, serta dokumen resmi.">
  <meta name="keywords" content="APBDes, Desa Ulukalo, Transparansi, Kolaka, Sulawesi Tenggara">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Poppins:wght@300;400;500;600;700;800;900&family=Raleway:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

  <style>
    .apb-cards .card { border: 0; border-radius: 14px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    .apb-cards .label { color:#6c757d; font-size:.9rem; }
    .apb-cards .value { font-weight:700; font-size:1.25rem; }
    .apb-section { border-radius:14px; }
    .doc-card { border:1px solid #e9ecef; border-radius:14px; transition:.2s; }
    .doc-card:hover { transform: translateY(-3px); box-shadow:0 10px 24px rgba(0,0,0,.08); }
    .table thead th { background:#f8f9fa; position: sticky; top: 0; z-index: 1; }
    .year-select { height:48px; }
    .apb-legend small{color:#6c757d}
    .infografis { border-radius:14px; border:1px solid #e9ecef; }
  </style>
</head>

<body class="about-page">

  <!-- ======= Header ======= -->
  <header id="header" class="header d-flex align-items-center sticky-top">
    <div class="container-fluid container-xl position-relative d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center">
        <!-- <img src="assets/img/logo-ulukalo.png" alt="Logo Desa Ulukalo"> -->
        <i class="bi bi-bank"></i>
        <h1 class="sitename">Desa Ulukalo</h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="index.html">Beranda</a></li>

          <li class="dropdown">
            <a href="sejarah.html"><span>Profil</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="sejarah.html">Sejarah Desa</a></li>
              <li><a href="visi-misi.html">Visi &amp; Misi</a></li>
              <li><a href="struktur-desa.html">Struktur Desa</a></li>
            </ul>
          </li>

          <li class="dropdown">
            <a href="pemerintahan.html"><span>Pemerintahan</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="pemerintahan.html">Aparat Desa &amp; Kepala Dusun</a></li>
            </ul>
          </li>

          <li><a href="apbdes.html" class="active">APBDes</a></li>
          <li><a href="layanan-surat.html">Layanan Surat</a></li>
          <li><a href="kontak.html">Kontak</a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>

    </div>
  </header>
  <!-- End Header -->

  <main class="main">

    <!-- ======= Page Title ======= -->
    <div class="page-title">
      <div class="heading">
        <div class="container">
          <div class="row d-flex justify-content-center text-center">
            <div class="col-lg-8">
              <h1 class="heading-title">APBDes Desa Ulukalo</h1>
              <p class="mb-0">Ringkasan Anggaran Pendapatan dan Belanja Desa beserta dokumen resmi per tahun anggaran.</p>
            </div>
          </div>
        </div>
      </div>
      <nav class="breadcrumbs">
        <div class="container">
          <ol>
            <li><a href="index.html">Beranda</a></li>
            <li class="current">APBDes</li>
          </ol>
        </div>
      </nav>
    </div>
    <!-- End Page Title -->

    <!-- ======= Filter Tahun & Unduhan Cepat ======= -->
    <section class="section">
      <div class="container">
        <div class="row g-3 align-items-center mb-3">
          <div class="col-md-4">
            <label class="form-label mb-1">Tahun Anggaran</label>
            <select id="tahunSelect" class="form-select year-select"></select>
          </div>
          <div class="col-md-8">
            <div class="d-flex flex-wrap gap-2 mt-3 mt-md-0">
              <a id="btnAPB" class="btn btn-dark" target="_blank" rel="noopener">
                <i class="bi bi-file-earmark-pdf me-1"></i> Unduh Dokumen APBDes
              </a>
              <a id="btnPerdes" class="btn btn-outline-dark" target="_blank" rel="noopener">
                <i class="bi bi-file-text me-1"></i> Perdes APBDes
              </a>
              <a id="btnLRA" class="btn btn-outline-dark" target="_blank" rel="noopener">
                <i class="bi bi-journal-check me-1"></i> Laporan Realisasi
              </a>
              <a id="btnRAB" class="btn btn-outline-dark" target="_blank" rel="noopener">
                <i class="bi bi-clipboard-data me-1"></i> RAB
              </a>
            </div>
            <div class="apb-legend mt-2"><small>Berkas PDF diletakkan di <code>assets/docs/</code> (lihat bagian bawah untuk penamaan file).</small></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ======= Ringkasan Anggaran ======= -->
    <section class="section">
      <div class="container">
        <div class="row g-3 apb-cards">
          <div class="col-md-3">
            <div class="card p-3">
              <div class="label">Pendapatan</div>
              <div id="vPendapatan" class="value">Rp -</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card p-3">
              <div class="label">Belanja</div>
              <div id="vBelanja" class="value">Rp -</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card p-3">
              <div class="label">Pembiayaan (Netto)</div>
              <div id="vPembiayaan" class="value">Rp -</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card p-3">
              <div class="label">SILPA/Defisit</div>
              <div id="vSilpa" class="value">Rp -</div>
            </div>
          </div>
        </div>
        <p class="text-muted small mt-2 mb-0">SILPA = Pendapatan + Penerimaan Pembiayaan - Pengeluaran Pembiayaan - Belanja.</p>
      </div>
    </section>

    <!-- ======= Rincian Pendapatan & Belanja ======= -->
    <section class="section">
      <div class="container">
        <div class="row g-4">
          <!-- Pendapatan -->
          <div class="col-lg-6">
            <div class="p-3 p-lg-4 border apb-section">
              <h3 class="h5 mb-3">Rincian Pendapatan</h3>
              <div class="table-responsive" style="max-height:420px;">
                <table class="table align-middle">
                  <thead>
                    <tr>
                      <th style="width:60%">Uraian</th>
                      <th class="text-end">Anggaran</th>
                    </tr>
                  </thead>
                  <tbody id="tPendapatan"></tbody>
                  <tfoot>
                    <tr>
                      <th>Total Pendapatan</th>
                      <th id="tPendapatanTotal" class="text-end">Rp -</th>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
          <!-- Belanja -->
          <div class="col-lg-6">
            <div class="p-3 p-lg-4 border apb-section">
              <h3 class="h5 mb-3">Rincian Belanja</h3>
              <div class="table-responsive" style="max-height:420px;">
                <table class="table align-middle">
                  <thead>
                    <tr>
                      <th style="width:60%">Bidang/Kegiatan</th>
                      <th class="text-end">Anggaran</th>
                    </tr>
                  </thead>
                  <tbody id="tBelanja"></tbody>
                  <tfoot>
                    <tr>
                      <th>Total Belanja</th>
                      <th id="tBelanjaTotal" class="text-end">Rp -</th>
                    </tr>
                  </tfoot>
                </table>
              </div>
              <div class="mt-3 small text-muted">
                Kelompok belanja umum: Penyelenggaraan Pemerintahan Desa, Pembangunan, Pembinaan Kemasyarakatan, Pemberdayaan Masyarakat, Penanggulangan Bencana (sesuaikan dengan APBDes resmi).
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ======= Dokumen & Infografis ======= -->
    <section class="section">
      <div class="container">
        <div class="row g-4">
          <div class="col-lg-7">
            <div class="p-3 p-lg-4 border apb-section h-100">
              <h3 class="h5 mb-3">Dokumen Lain</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <a id="btnRealisasi1" class="doc-card d-flex align-items-center p-3 text-decoration-none" target="_blank" rel="noopener">
                    <i class="bi bi-file-earmark-bar-graph fs-4 me-3"></i>
                    <div>
                      <div class="fw-semibold">Realisasi Semester I</div>
                      <small class="text-muted">PDF</small>
                    </div>
                  </a>
                </div>
                <div class="col-md-6">
                  <a id="btnRealisasi2" class="doc-card d-flex align-items-center p-3 text-decoration-none" target="_blank" rel="noopener">
                    <i class="bi bi-file-earmark-bar-graph fs-4 me-3"></i>
                    <div>
                      <div class="fw-semibold">Realisasi Semester II</div>
                      <small class="text-muted">PDF</small>
                    </div>
                  </a>
                </div>
                <div class="col-md-6">
                  <a id="btnInfografis" class="doc-card d-flex align-items-center p-3 text-decoration-none" target="_blank" rel="noopener">
                    <i class="bi bi-image fs-4 me-3"></i>
                    <div>
                      <div class="fw-semibold">Infografis APBDes</div>
                      <small class="text-muted">Gambar</small>
                    </div>
                  </a>
                </div>
              </div>
              <div class="mt-3 small text-muted">Simpan berkas di <code>assets/docs/</code> dan gambar di <code>assets/img/apbdes/</code>.</div>
            </div>
          </div>
          <div class="col-lg-5">
            <div class="p-3 p-lg-4 border apb-section">
              <h3 class="h5 mb-3">Pratinjau Infografis</h3>
              <a id="imgLink" target="_blank" rel="noopener">
                <img id="imgInfo" class="img-fluid infografis" src="assets/img/apbdes/placeholder.png" alt="Infografis APBDes">
              </a>
              <div class="small text-muted mt-2">Ganti dengan file infografis per tahun.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ======= Petunjuk Penempatan Berkas ======= -->
    <section class="section">
      <div class="container">
        <div class="p-3 p-lg-4 border apb-section">
          <h3 class="h6 mb-2">Petunjuk singkat:</h3>
          <ol class="mb-0 small">
            <li>Letakkan data di <code>assets/js/apbdes.json</code> dengan struktur per tahun.</li>
            <li>PDF: taruh di <code>assets/docs/</code> (contoh: <code>apbdes-2025.pdf</code>, <code>perdes-apbdes-2025.pdf</code>, <code>lra-2025.pdf</code>, <code>rab-2025.pdf</code>, <code>realisasi-sem1-2025.pdf</code>, <code>realisasi-sem2-2025.pdf</code>).</li>
            <li>Infografis: <code>assets/img/apbdes/infografis-2025.png</code>.</li>
          </ol>
        </div>
      </div>
    </section>

  </main>

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer-16 footer position-relative dark-background">
    <div class="container">
      <div class="footer-main">
        <div class="row align-items-start">

          <div class="col-lg-6">
            <div class="brand-section">
              <a href="index.html" class="logo d-flex align-items-center mb-3">
                <span class="sitename">Desa Ulukalo</span>
              </a>
              <p class="brand-description">
                Kantor Desa Ulukalo, Kabupaten Kolaka, Sulawesi Tenggara. Informasi resmi profil,
                pemerintahan, layanan surat, serta transparansi APBDes.
              </p>

              <div class="contact-info mt-4">
                <div class="contact-item">
                  <i class="bi bi-geo-alt"></i>
                  <span>Alamat kantor: [isi alamat lengkap]</span>
                </div>
                <div class="contact-item">
                  <i class="bi bi-telephone"></i>
                  <span>Telp/WA: [isi nomor]</span>
                </div>
                <div class="contact-item">
                  <i class="bi bi-envelope"></i>
                  <span>Email: [isi email]</span>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="row">
              <div class="col-6">
                <h6>Profil</h6>
                <nav class="footer-nav">
                  <a href="sejarah.html">Sejarah</a>
                  <a href="visi-misi.html">Visi &amp; Misi</a>
                  <a href="struktur-desa.html">Struktur Desa</a>
                </nav>
              </div>
              <div class="col-6">
                <h6>Layanan</h6>
                <nav class="footer-nav">
                  <a href="pemerintahan.html">Aparat &amp; Kadus</a>
                  <a href="apbdes.html">APBDes</a>
                  <a href="layanan-surat.html">Layanan Surat</a>
                  <a href="kontak.html">Kontak</a>
                </nav>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="footer-bottom mt-4">
        <div class="bottom-content d-flex flex-wrap justify-content-between align-items-center">
          <div class="copyright">
            <p>© <span class="sitename">Desa Ulukalo</span> — Semua hak dilindungi.</p>
          </div>
          <div class="legal-links">
            <a href="kebijakan-privasi.html">Kebijakan Privasi</a>
            <a href="syarat-penggunaan.html">Syarat Penggunaan</a>
          </div>
        </div>
      </div>

    </div>
  </footer>
  <!-- End Footer -->

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>

  <!-- ======= APBDes Render Script ======= -->
  <script>
    const fmt = n => new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR', maximumFractionDigits:0}).format(n||0);

    const els = {
      tahun: document.getElementById('tahunSelect'),
      vPendapatan: document.getElementById('vPendapatan'),
      vBelanja: document.getElementById('vBelanja'),
      vPembiayaan: document.getElementById('vPembiayaan'),
      vSilpa: document.getElementById('vSilpa'),
      tPendapatan: document.getElementById('tPendapatan'),
      tBelanja: document.getElementById('tBelanja'),
      tPendapatanTotal: document.getElementById('tPendapatanTotal'),
      tBelanjaTotal: document.getElementById('tBelanjaTotal'),
      btnAPB: document.getElementById('btnAPB'),
      btnPerdes: document.getElementById('btnPerdes'),
      btnLRA: document.getElementById('btnLRA'),
      btnRAB: document.getElementById('btnRAB'),
      btnRealisasi1: document.getElementById('btnRealisasi1'),
      btnRealisasi2: document.getElementById('btnRealisasi2'),
      btnInfografis: document.getElementById('btnInfografis'),
      imgInfo: document.getElementById('imgInfo'),
      imgLink: document.getElementById('imgLink'),
    };

    let DB = {};

    function sum(obj){
      return Object.values(obj||{}).reduce((a,b)=>a+(+b||0),0);
    }

    function setHref(a, href){
      if (href){ a.href = href; a.classList.remove('disabled'); a.setAttribute('aria-disabled','false'); }
      else { a.href = '#'; a.classList.add('disabled'); a.setAttribute('aria-disabled','true'); }
    }

    function renderYear(y){
      const d = DB[y] || {};
      const pend = d.pendapatan || {};
      const bel = d.belanja || {};
      const pbi = d.pembiayaan || { "Penerimaan": 0, "Pengeluaran": 0 };

      // cards
      const totalPend = sum(pend);
      const totalBel = sum(bel);
      const netto = (+pbi["Penerimaan"]||0) - (+pbi["Pengeluaran"]||0);
      const silpa = totalPend + (+pbi["Penerimaan"]||0) - (+pbi["Pengeluaran"]||0) - totalBel;

      els.vPendapatan.textContent = fmt(totalPend);
      els.vBelanja.textContent = fmt(totalBel);
      els.vPembiayaan.textContent = fmt(netto);
      els.vSilpa.textContent = fmt(silpa);

      // tables
      const trp = Object.entries(pend).map(([k,v])=>`<tr><td>${k}</td><td class="text-end">${fmt(v)}</td></tr>`).join('') || `<tr><td colspan="2" class="text-center text-muted">Belum ada data</td></tr>`;
      const trb = Object.entries(bel).map(([k,v])=>`<tr><td>${k}</td><td class="text-end">${fmt(v)}</td></tr>`).join('') || `<tr><td colspan="2" class="text-center text-muted">Belum ada data</td></tr>`;
      els.tPendapatan.innerHTML = trp;
      els.tBelanja.innerHTML = trb;
      els.tPendapatanTotal.textContent = fmt(totalPend);
      els.tBelanjaTotal.textContent = fmt(totalBel);

      // docs
      const doc = d.dokumen || {};
      setHref(els.btnAPB, doc.apbdes);
      setHref(els.btnPerdes, doc.perdes);
      setHref(els.btnLRA, doc.laporan || doc['lra']);
      setHref(els.btnRAB, doc.rab);
      setHref(els.btnRealisasi1, doc['realisasi-sem1']);
      setHref(els.btnRealisasi2, doc['realisasi-sem2']);
      setHref(els.btnInfografis, doc.infografis);

      if (doc.infografis){
        els.imgInfo.src = doc.infografis;
        els.imgLink.href = doc.infografis;
      } else {
        els.imgInfo.src = 'assets/img/apbdes/placeholder.png';
        els.imgLink.href = '#';
      }
    }

    function initYears(){
      const years = Object.keys(DB).sort((a,b)=> (+b) - (+a));
      if (years.length === 0){
        const now = new Date().getFullYear();
        DB[now] = {
          pendapatan: {
            "Dana Desa (DD)": 0,
            "Alokasi Dana Desa (ADD)": 0,
            "Bagi Hasil Pajak & Retribusi": 0,
            "Lain-lain Pendapatan Desa": 0
          },
          belanja: {
            "Penyelenggaraan Pemerintahan Desa": 0,
            "Pembangunan Desa": 0,
            "Pembinaan Kemasyarakatan": 0,
            "Pemberdayaan Masyarakat": 0,
            "Penanggulangan Bencana/Keadaan Mendesak": 0
          },
          pembiayaan: { "Penerimaan": 0, "Pengeluaran": 0 },
          dokumen: {
            apbdes: "assets/docs/apbdes-"+now+".pdf",
            perdes: "assets/docs/perdes-apbdes-"+now+".pdf",
            rab: "assets/docs/rab-"+now+".pdf",
            "realisasi-sem1": "assets/docs/realisasi-sem1-"+now+".pdf",
            "realisasi-sem2": "assets/docs/realisasi-sem2-"+now+".pdf",
            laporan: "assets/docs/lra-"+now+".pdf",
            infografis: "assets/img/apbdes/infografis-"+now+".png"
          }
        };
        years.push(now.toString());
      }

      els.tahun.innerHTML = years.map(y=>`<option value="${y}">${y}</option>`).join('');
      renderYear(years[0]);
      els.tahun.value = years[0];
      els.tahun.addEventListener('change', e => renderYear(e.target.value));
    }

    fetch('assets/js/apbdes.json')
      .then(r => r.ok ? r.json() : Promise.reject())
      .then(json => { DB = json || {}; initYears(); })
      .catch(() => { DB = {}; initYears(); });
  </script>

</body>
</html>
